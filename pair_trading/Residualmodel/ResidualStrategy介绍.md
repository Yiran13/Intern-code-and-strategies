### 背景介绍
ResidualStrategy是一种基于统计套利的配对策略。不同于传统CTA策略，该策略对交易品种有严格的统计学假设。该策略主要涉及的统计学知识有:**协整关系**,**线性回归** 和**均值回归**

### Residual策略描述
该策略需要同时交易两个品种A和B，且这两个品种需要满足**协整关系**(交易品种的选择是在**策略之外**进行的)。
从学术文献和网络上的资料可以得知，Residual策略基本上涉及下面的几点内容：

- 将A和B的收盘价序列记为 A(t),B(t)
- 对收盘价序列 A(t) 和 B(t) 做**动态**线性回归： A(t) = β * B(t) + α + R(t)
- 对线性回归的残差序列 R(t) 计算标准差，形成残差的标准差序列 S(t)
- 对线性回归的残差序列 R(t) 计算均值，形成残差的均值序列 M(t)
- 基于标准差和均值序列 S(t) 和 M(t)，形成残差的上轨和下轨序列 U(t)，D(t)
- 当残差突破上轨做空残差，残差跌破下轨做多残差

### Residual策略实现

在策略的具体实现过程中还需要增加如下参数：

- 对收盘价序列 Y(t) 和 X(t) 做**动态**线性回归:
  - `hedge_ratio_window`  使用多少**根**bar进行线性回归
  - `renew_interval` 过多少**天**重新进行线性回归计算
- 对线性回归的残差序列 R(t) 计算标准差，形成残差的标准差序列 S(t)
  - `std_window`计算标准差的时间窗
- 对线性回归的残差序列 R(t) 计算均值，形成残差的均值序列 M(t)
  - `mean_window`计算均值的时间窗
- 基于标准差和均值序列 S(t) 和 M(t)，形成残差的上轨和下轨序列 U(t)，D(t)
  - `entry_multiplier` 轨道宽度
- 信号过滤
  - `spread_volume_threshold` 过滤上一根bar交易量低迷的情况
  - `difference_filter_num` 过滤上或下轨距离中轴太近的情况
- 止损
  - `difference_exit_num`  避免交易品种发生结构性变化,导致残差不会向均值**回归**的情况

### Residual策略实证



#### 交易品种选择

我们利用 2019-01-01 到 2019-03-31 的RQDATA888 1分钟连续主力合约数据，将交易时间一致的期货品种两两配对形成 pair trading pool。 对 pair trading pool 中的期货品种组合进行**协整测试**， 一共筛选出了 5 对满足条件期货品种组合: (CU888, NI888) , (L888,PP888), (V888, PP888), (EG888, PP888), (HC888, RB888)。

